/**
 * Autogenerated <%= name %> controller.
 */
var turnpike = require('turnpike');
var util     = require('util');

function <%= name %>(connection) {
  turnpike.EndpointController.call(this, connection);
}
util.inherits(<%= name %>, turnpike.EndpointController);

/*
 * Your field map function is used to map request body and query fields to
 * model fields when their names don't match exactly. In almost all cases,
 * with this defined, you won't need to override any of the action methods
 * below.
 */
//<%= name %>.prototype.fieldMapper = turnpike.fieldMap({});

//List items
/****** Delete this line to override this action ******
<%= name %>.prototype.index = function(readyCallback) {
  if (this.model){
    var skip = this.connection.req.query.index;
    var params = new this.model.Item();

    for (property in params) {
      if (this.connection.req.query[property]) {
        params[property] = this.connection.req.query[property];
      }
    }

    this.model.index(params, skip, (function(err, data) {
      this.data = data;
      process.nextTick(readyCallback);
    }).bind(this));
  }
  else {
    this.connection.die(405);
  }
};
// */

//Display a single item
/****** Delete this line to override this action ******
<%= name %>.prototype.main = function(readyCallback) {
  if (this.model)  {
    var item = new this.model.Item();
    item._id = this.connection.route.params.id;
    this.model.load(item, (function(err, item){
      if (err) {
        this.connection.die(500);
      }
      else if (!item) {
        this.connection.die(404);
      }
      else {
        this.data = item;
        process.nextTick(readyCallback);
      }
    }).bind(this));
  }
  else {
    this.connection.die(405);
  }
};
// */

//Remove an item
/****** Delete this line to override this action ******
<%= name %>.prototype.remove = function(readyCallback) {
  if (this.model){
    var item = new this.model.Item();
    item._id = this.connection.route.params.id;
    this.model.remove(item, function(err, removed) {
      this.data.removed = removed;
      process.nextTick(readyCallback);
    });
  }
  else {
    this.connection.die(405);
  }
};
// */

//Form for confirming deletion via web interface
/****** Delete this line to override this action ******
<%= name %>.prototype.removeForm = function(readyCallback) {
  if (this.model) {
    var item = new this.model.Item();
    item._id = this.connection.route.params.id;
    this.model.load(item, (function(err, item){
      if (err) {
        this.connection.die(500);
      }
      else if (!item) {
        this.connection.die(404);
      }
      else {
        if (Session.csrf.state) {
          item._csrf = this.connection.req.csrfToken();
        }

        this.data = item;
        process.nextTick(readyCallback);
      }
    }).bind(this));
  }
  else {
    this.connection.die(405);
  }
};
module.exports = <%= name %>;
// */


<%= name %>.prototype.edit = function(readyCallback) {

}
